# خطة تطوير وتحسين لوحة التحكم (Dashboard)

## نظرة عامة
تحديث شامل للوحة التحكم مع الحفاظ على الهوية البصرية للتطبيق (تصميم MicroHeader، ألوان متناسقة، خط Cairo).

---

## المرحلة 1: تحسين البنية التحتية ✅

### 1.1 تحديث ملفات البيانات
- [x] `src/data/dashboard.ts` - بيانات افتراضية للعرض
- [ ] ربط البيانات الحقيقية من Supabase

### 1.2 تحديث الـ Hooks
- [x] `src/features/dashboard/hooks/useDashboard.ts` - موجود
- [ ] إضافة `useDashboardRealtime` للتحديثات الفورية
- [ ] إضافة `useDashboardFilters` للفلترة

---

## المرحلة 2: إعادة تصميم المكونات 🎨

### 2.1 StatsGrid (إحصائيات سريعة)
**الحالي:** عرض بسيط للإحصائيات
**المطلوب:**
```
┌─────────────────────────────────────────────────────────────┐
│  💰 المبيعات    │  📦 المشتريات  │  💸 المصروفات  │  📊 الأرباح  │
│   125,000      │    45,000     │    12,000     │    68,000   │
│   +12.5% ↑     │   -3.2% ↓     │   +5.1% ↑     │   +8.4% ↑   │
└─────────────────────────────────────────────────────────────┘
```

**التحسينات:**
- إضافة نسبة التغير
- ألوان متدرجة حسب الأداء
- أيقونات متحركة

### 2.2 SalesChart (رسم المبيعات)
**الحالي:** AreaChart بسيط
**المطلوب:**
```
┌──────────────────────────────────────────────────────────────┐
│  📈 تحليل المبيعات                    [يوم][أسبوع][شهر][سنة] │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│     ╭──────────────────────────────────────────────╮        │
│     │         ▓▓▓▓▓▓▓▓                             │        │
│     │    ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓                        │        │
│     │ ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓                    │        │
│     ╰──────────────────────────────────────────────╯        │
│                                                              │
│  إجمالي: 125,000  │  متوسط: 4,166  │  أعلى: 8,500         │
└──────────────────────────────────────────────────────────────┘
```

**التحسينات:**
- محدد الفترة الزمنية
- ملخص سريع أسفل الرسم
- تدرج لوني أفضل

### 2.3 Targets Section (الأهداف)
**الحالي:** شريط تقدم بسيط
**المطلوب:**
```
┌────────────────────────────────────────────┐
│  🎯 الأهداف الشهرية                        │
├────────────────────────────────────────────┤
│                                            │
│  المبيعات                                  │
│  ████████████████░░░░  78%                │
│  78,000 / 100,000                          │
│                                            │
│  التحصيل                                   │
│  ████████████████████  95%                │
│  47,500 / 50,000                           │
│                                            │
│  المصروفات                                 │
│  ████████░░░░░░░░░░░░  40%                │
│  8,000 / 20,000 (أقل = أفضل)              │
│                                            │
└────────────────────────────────────────────┘
```

---

## المرحلة 3: إضافة مكونات جديدة 🆕

### 3.1 QuickInsights (رؤى سريعة)
```
┌─────────────────────────────────────────────────────────────┐
│  💡 رؤى ذكية                                                │
├─────────────────────────────────────────────────────────────┤
│  ⚡ المبيعات اليوم أعلى بـ 15% من المتوسط                   │
│  📦 5 منتجات قاربت على النفاد                               │
│  💰 3 فواتير متأخرة التحصيل                                 │
│  🎯 أنت قريب من تحقيق هدف الشهر بـ 22%                      │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 CashFlowWidget (تدفق النقدية)
```
┌─────────────────────────────────────────────────────────────┐
│  💵 التدفق النقدي                                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│     القبض ████████████████████ +85,000                     │
│     الصرف ████████ -35,000                                  │
│     ───────────────────────────────────                     │
│     الصافي ██████████████ +50,000                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 TopPerformers (الأداء الأعلى)
```
┌────────────────────────┐  ┌────────────────────────┐
│  🏆 المنتجات الأكثر    │  │  👥 العملاء الأكثر     │
│     مبيعاً             │  │     شراءً              │
├────────────────────────┤  ├────────────────────────┤
│  1. منتج A - 2,500    │  │  1. أحمد - 15,000     │
│  2. منتج B - 1,800    │  │  2. سارة - 12,500     │
│  3. منتج C - 1,200    │  │  3. محمد - 8,000      │
└────────────────────────┘  └────────────────────────┘
```

### 3.4 AlertsPanel (التنبيهات الذكية)
```
┌─────────────────────────────────────────────────────────────┐
│  🔔 التنبيهات                          [الكل][عاجل][معلومات] │
├─────────────────────────────────────────────────────────────┤
│  🔴 عاجل: مخزون المنتج X قليل جداً (5 قطع)                  │
│  🟡 تنبيه: فاتورة #123 متأخرة 7 أيام                       │
│  🟢 معلومات: تم تحقيق 75% من هدف المبيعات                   │
└─────────────────────────────────────────────────────────────┘
```

---

## المرحلة 4: تحسين التفاعلية ⚡

### 4.1 الفلاتر العامة
```typescript
interface DashboardFilters {
  period: 'today' | 'week' | 'month' | 'quarter' | 'year';
  branch?: string;
  warehouse?: string;
  compareWithPrevious: boolean;
}
```

### 4.2 التحديث الفوري
- WebSocket للتحديثات المباشرة
- Refresh يدوي مع حالة تحميل
- Cache ذكي للبيانات

### 4.3 التخصيص
- إمكانية إخفاء/إظهار المكونات
- ترتيب المكونات بالسحب والإفلات
- حفظ التفضيلات في localStorage

---

## المرحلة 5: الأداء والأمان 🛡️

### 5.1 تحسين الأداء
- Lazy loading للمكونات الثقيلة
- Memoization للبيانات
- Virtualization للقوائم الطويلة

### 5.2 معالجة الأخطاء
- Error Boundary لكل مكون
- Fallback UI للرسوم البيانية
- Retry logic للبيانات

---

## الهوية البصرية (الحفاظ عليها)

### الألوان
```css
--primary: #3b82f6;     /* أزرق - الرئيسي */
--success: #10b981;     /* أخضر - النجاح */
--warning: #f59e0b;     /* برتقالي - التحذير */
--danger: #ef4444;      /* أحمر - الخطر */
--info: #06b6d4;        /* سماوي - معلومات */
```

### الخطوط
```css
font-family: 'Cairo', sans-serif;
```

### الظلال
```css
/* بطاقات */
box-shadow: 0 1px 3px rgba(0,0,0,0.1);

/* العناصر المحددة */
box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);

/* الأزرار */
box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
```

### الحواف
```css
/* كبيرة */
border-radius: 2.5rem;

/* متوسطة */
border-radius: 1rem;

/* صغيرة */
border-radius: 0.5rem;
```

---

## ترتيب التنفيذ

| الأولوية | المهمة | المدة التقديرية |
|---------|--------|----------------|
| 1 | تحديث StatsGrid | 2 ساعة |
| 2 | تحسين SalesChart | 2 ساعة |
| 3 | إضافة QuickInsights | 1.5 ساعة |
| 4 | إضافة CashFlowWidget | 1.5 ساعة |
| 5 | تحسين Targets | 1 ساعة |
| 6 | إضافة TopPerformers | 1 ساعة |
| 7 | AlertsPanel | 1 ساعة |
| 8 | الفلاتر والتفاعلية | 2 ساعة |
| **المجموع** | | **12 ساعة** |

---

## ملفات للإنشاء/التعديل

### ملفات جديدة
- `src/features/dashboard/components/QuickInsights.tsx`
- `src/features/dashboard/components/CashFlowWidget.tsx`
- `src/features/dashboard/components/TopPerformers.tsx`
- `src/features/dashboard/components/AlertsPanel.tsx`
- `src/features/dashboard/components/DashboardFilters.tsx`

### ملفات للتعديل
- `src/features/dashboard/DashboardPage.tsx`
- `src/features/dashboard/hooks/useDashboard.ts`
- `src/ui/dashboard/StatsGrid.tsx`
- `src/ui/dashboard/SalesChart.tsx`
- `src/data/dashboard.ts`

---

## ملاحظات إضافية

1. **التوافق:** التأكد من عمل لوحة التحكم على الأجهزة المختلفة
2. **الوضع الداكن:** دعم كامل للوضع الداكن
3. **RTL:** الحفاظ على دعم اللغة العربية
4. **Accessibility:** إضافة ARIA labels للعناصر التفاعلية
